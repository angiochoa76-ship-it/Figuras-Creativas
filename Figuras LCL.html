<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dibujador de Figuras Canvas (27 Figuras)</title>
    <style>
        /* ========================
            ESTILOS GENERALES Y LAYOUT
            ======================== */
        body {
            font-family: 'Arial', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            background-color: #071b3d; /* Fondo oscuro */
            color: #fff;
            padding: 0;
            margin: 0;
            overflow: hidden; /* Evita barras de desplazamiento innecesarias */
            height: 100vh;
        }

        /* Contenedor principal de la aplicaci칩n (Oculto al inicio) */
        #app-content {
            display: none; /* Inicialmente oculto */
            width: 100%;
            height: 100%;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            box-sizing: border-box;
        }

        header {
            margin-bottom: 20px;
            font-size: 1.2em;
            color: #f5e6e6;
        }

        .container {
            display: flex;
            gap: 20px;
            width: 100%;
            max-width: 1200px;
            flex-grow: 1; /* Permite que el contenedor crezca y ocupe el espacio */
        }

        /* ========================
            ESTILOS DE CONTROLES Y CANVAS
            ======================== */
        .controls {
            flex: 1;
            padding: 20px;
            background-color: #222;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);
            height: fit-content;
            max-height: 90vh; /* Limita la altura de los controles */
            overflow-y: auto; /* Permite scroll si hay muchos par치metros/figuras */
        }

        .controls label, .controls select, .controls input[type="number"], .controls input[type="color"], .controls button {
            display: block;
            margin-bottom: 10px;
            width: calc(100% - 20px);
            padding: 8px;
            border-radius: 4px;
            border: 1px solid #555;
            box-sizing: border-box;
        }

        .controls select, .controls input[type="number"] {
            background-color: #444;
            color: #fff;
        }

        .controls button {
            width: 100%;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.3s;
        }

        #dibujarBtn {
            background-color: #4CAF50;
            color: white;
            margin-top: 15px;
        }

        #limpiarBtn {
            background-color: #f44336;
            color: white;
        }

        #dibujarBtn:hover {
            background-color: #45a049;
        }

        #limpiarBtn:hover {
            background-color: #d32f2f;
        }

        .color-group {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .color-group label {
            flex: 1;
            margin-bottom: 0;
            padding: 0;
            border: none;
            display: inline;
        }

        .color-group input[type="color"] {
            width: 50px;
            height: 30px;
            padding: 0;
            border: none;
            cursor: pointer;
        }

        #parametros label {
            display: inline-block;
            width: 95px; /* Ancho fijo para las etiquetas de par치metros */
        }
        
        #parametros input[type="number"] {
            width: calc(100% - 105px);
            display: inline-block;
        }

        #canvas {
            flex: 3;
            background-color: #fff;
            border: 5px solid #1e90ff;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.6);
            /* Asegurarse de que el canvas se ajuste bien */
            max-width: 100%;
            max-height: 100%;
        }

        .error-message {
            color: #ffcc00;
            margin-top: 10px;
            font-weight: bold;
        }

        /* ========================
            ESTILOS INTERFAZ DE INICIO (SPLASH SCREEN)
            ======================== */
        #splash-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #071b3d; /* Fondo oscuro de la intro */
            color: #fff;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            z-index: 1000; /* Asegura que est칠 por encima de todo */
            transition: opacity 0.5s ease-out;
        }

        #splash-screen h1 {
            font-size: 3em;
            color: #d25d09; /* Color azul distintivo */
            margin-bottom: 10px;
            border-bottom: 3px solid #d25d09;
            padding-bottom: 10px;
        }

        #splash-screen p {
            font-size: 1.5em;
            margin-bottom: 30px;
            color: #ccc;
        }

        #iniciarAppBtn {
            padding: 15px 30px;
            font-size: 1.2em;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        #iniciarAppBtn:hover {
            background-color: #45a049;
        }

        /* Clase para ocultar con transici칩n */
        .hidden {
            opacity: 0;
            visibility: hidden;
        }
    </style>
</head>
<body>
    
    <div id="splash-screen">
        <h1>GEOMETR칈A CREATIVA</h1>
        <p>Tu herramienta interactiva para dibujar figuras en Canvas. 춰27 opciones disponibles! 游</p>
        <button id="iniciarAppBtn">Comenzar a Dibujar</button>
    </div>

    <div id="app-content">
        <header>
            <p>Selecciona una figura y ajusta sus par치metros, Luego 춰Presiona en dibujar! 游꿛</p>
        </header>

        <div class="container">
            <aside class="controls">
                <label for="figura">Elige la figura:</label>
                <select id="figura">
                    <option value="cuadrado">Cuadrado</option>
                    <option value="rectangulo">Rect치ngulo</option>
                    <option value="triangulo">Tri치ngulo Equil치tero</option>
                    <option value="circulo">C칤rculo</option>
                    <option value="corazon">Coraz칩n</option>
                    <option value="pentagono">Pent치gono Regular</option>
                    <option value="ovalado">칍valo (Elipse)</option>
                    <option value="hexagono">Hex치gono Regular</option>
                    <option value="octogono">Oct칩gono Regular</option>
                    <option value="rombo">Rombo</option>
                    <option value="trapecio">Trapecio</option>
                    <option value="estrella5">Estrella de 5 Puntas</option>
                    <option value="estrella6">Estrella de 6 Puntas</option>
                    <option value="mediaLuna">Media Luna</option>
                    <option value="arco">Arco</option>
                    <option value="donut">Donut (Anillo)</option>
                    <option value="flecha">Flecha</option>
                    <option value="nuve">Nube</option>
                    <option value="diamante">Diamante</option>
                    <option value="rectanguloRedondeado">Rect치ngulo Redondeado</option>
                    <option value="trianguloRectangulo">Tri치ngulo Rect치ngulo</option>
                    <option value="pino">Pino</option>
                    <option value="gota">Gota</option>
                    <option value="bandera">Bandera</option>
                    <option value="engranaje">Engranaje</option>
                    <option value="cruz">Cruz</option>
                    <option value="pacman">Pacman</option>
                    <option value="rayo">Rayo</option>
                    <option value="bala">Bala</option>
                    <option value="tetaedro">Tetraedro (Vista)</option>
                    <option value="espiral">Espiral</option>
                    <option value="escalera">Escalera</option>
                </select>
                <hr>
                
                <div id="parametros">
                    </div>
                
                <hr>

                <div class="color-group">
                    <label for="colorBorde">Color borde:</label>
                    <input type="color" id="colorBorde" value="#000080">
                </div>
                <div class="color-group">
                    <label for="colorRelleno">Color relleno:</label>
                    <input type="color" id="colorRelleno" value="#87CEEB">
                </div>

                <button id="dibujarBtn">Dibujar</button>
                <button id="limpiarBtn">Limpiar Canvas</button>

                <div id="errorMessage" class="error-message"></div>
            </aside>

            <main>
                <canvas id="canvas" width="800" height="600"></canvas>
            </main>
        </div>
    </div>

    <script>
        // === Configuraci칩n de Figuras (Base de Datos) ===
        const figurasDB = {
            // --- FIGURAS ORIGINALES ---
            cuadrado: {
                label: 'Lado (px)', propKey: 'lado', default: 200,
                color: '#000080', fill: '#87CEEB',
                dibujar: function(ctx, params) {
                    const lado = params.lado;
                    const half = lado / 2;
                    ctx.rect(-half, -half, lado, lado);
                }
            },
            rectangulo: {
                labels: ['Base (px)', 'Altura (px)'], propKeys: ['base', 'altura'], defaults: [300, 150],
                color: '#006400', fill: '#90EE90',
                dibujar: function(ctx, params) {
                    const { base, altura } = params;
                    const halfBase = base / 2;
                    const halfAltura = altura / 2;
                    ctx.rect(-halfBase, -halfAltura, base, altura);
                }
            },
            triangulo: {
                label: 'Lado (px)', propKey: 'lado', default: 250,
                color: '#8B0000', fill: '#FFC0CB',
                dibujar: function(ctx, params) {
                    const lado = params.lado;
                    const altura = (Math.sqrt(3) / 2) * lado;
                    const halfBase = lado / 2;
                    ctx.moveTo(0, -altura / 2);
                    ctx.lineTo(-halfBase, altura / 2);
                    ctx.lineTo(halfBase, altura / 2);
                    ctx.closePath();
                }
            },
            circulo: {
                label: 'Radio (px)', propKey: 'radio', default: 150,
                color: '#EE82EE', fill: '#EE82EE',
                dibujar: function(ctx, params) {
                    const radio = params.radio;
                    ctx.arc(0, 0, radio, 0, 2 * Math.PI);
                }
            },
            corazon: {
                label: 'Tama침o Base (px)', propKey: 'lado', default: 250,
                color: '#FF0000', fill: '#FF69B4',
                dibujar: function(ctx, params) {
                    const lado = params.lado;
                    const scale = lado / 250;
                    const x = 0;
                    const y = 0;

                    ctx.moveTo(x, y - 40 * scale);
                    ctx.bezierCurveTo(
                        x - 75 * scale, y - 100 * scale,
                        x - 150 * scale, y + 25 * scale,
                        x, y + 100 * scale
                    );
                    ctx.bezierCurveTo(
                        x + 150 * scale, y + 25 * scale,
                        x + 75 * scale, y - 100 * scale,
                        x, y - 40 * scale
                    );
                    ctx.closePath();
                }
            },
            pentagono: {
                label: 'Radio Circunscrito (px)', propKey: 'radio', default: 200,
                color: '#DAA520', fill: '#F0E68C',
                dibujar: function(ctx, params) {
                    const radio = params.radio;
                    const numLados = 5;
                    const startAngle = -Math.PI / 2; 
                    const angleIncrement = (2 * Math.PI) / numLados;

                    for (let i = 0; i < numLados; i++) {
                        const angle = startAngle + i * angleIncrement;
                        const x = radio * Math.cos(angle);
                        const y = radio * Math.sin(angle);
                        
                        if (i === 0) {
                            ctx.moveTo(x, y);
                        } else {
                            ctx.lineTo(x, y);
                        }
                    }
                    ctx.closePath();
                }
            },
            ovalado: {
                labels: ['Radio X (px)', 'Radio Y (px)'], propKeys: ['radiusX', 'radiusY'], defaults: [300, 150],
                color: '#556B2F', fill: '#ADFF2F',
                dibujar: function(ctx, params) {
                    const { radiusX, radiusY } = params;
                    ctx.ellipse(0, 0, radiusX, radiusY, 0, 0, 2 * Math.PI);
                }
            },

            // --- 20 NUEVAS FIGURAS ---
            hexagono: {
                label: 'Radio Circunscrito (px)', propKey: 'radio', default: 180,
                color: '#8A2BE2', fill: '#E6E6FA',
                dibujar: function(ctx, params) {
                    const radio = params.radio;
                    const numLados = 6;
                    const angleIncrement = (2 * Math.PI) / numLados;
                    for (let i = 0; i < numLados; i++) {
                        const angle = i * angleIncrement;
                        const x = radio * Math.cos(angle);
                        const y = radio * Math.sin(angle);
                        (i === 0) ? ctx.moveTo(x, y) : ctx.lineTo(x, y);
                    }
                    ctx.closePath();
                }
            },
            octogono: {
                label: 'Radio Circunscrito (px)', propKey: 'radio', default: 150,
                color: '#FF4500', fill: '#FFDAB9',
                dibujar: function(ctx, params) {
                    const radio = params.radio;
                    const numLados = 8;
                    const angleIncrement = (2 * Math.PI) / numLados;
                    const startAngle = Math.PI / 8; 
                    for (let i = 0; i < numLados; i++) {
                        const angle = startAngle + i * angleIncrement;
                        const x = radio * Math.cos(angle);
                        const y = radio * Math.sin(angle);
                        (i === 0) ? ctx.moveTo(x, y) : ctx.lineTo(x, y);
                    }
                    ctx.closePath();
                }
            },
            rombo: {
                labels: ['Ancho (px)', 'Alto (px)'], propKeys: ['ancho', 'alto'], defaults: [250, 350],
                color: '#20B2AA', fill: '#B0E0E6',
                dibujar: function(ctx, params) {
                    const { ancho, alto } = params;
                    ctx.moveTo(0, -alto / 2);      
                    ctx.lineTo(ancho / 2, 0);     
                    ctx.lineTo(0, alto / 2);      
                    ctx.lineTo(-ancho / 2, 0);    
                    ctx.closePath();
                }
            },
            trapecio: {
                labels: ['Base Inferior', 'Base Superior', 'Altura'], propKeys: ['bInferior', 'bSuperior', 'altura'], defaults: [300, 150, 200],
                color: '#9932CC', fill: '#E6E0F8',
                dibujar: function(ctx, params) {
                    const { bInferior, bSuperior, altura } = params;
                    ctx.moveTo(-bInferior / 2, altura / 2); 
                    ctx.lineTo(bInferior / 2, altura / 2);  
                    ctx.lineTo(bSuperior / 2, -altura / 2); 
                    ctx.lineTo(-bSuperior / 2, -altura / 2); 
                    ctx.closePath();
                }
            },
            estrella5: {
                label: 'Radio Exterior (px)', propKey: 'radio', default: 200,
                color: '#FFD700', fill: '#FFFACD',
                dibujar: function(ctx, params) {
                    const radio = params.radio;
                    const radioInterior = radio / 2.5;
                    const numPuntas = 5;
                    const angleIncrement = Math.PI / numPuntas;
                    for (let i = 0; i < 2 * numPuntas; i++) {
                        const r = (i % 2 === 0) ? radio : radioInterior;
                        const angle = i * angleIncrement - Math.PI / 2;
                        const x = r * Math.cos(angle);
                        const y = r * Math.sin(angle);
                        (i === 0) ? ctx.moveTo(x, y) : ctx.lineTo(x, y);
                    }
                    ctx.closePath();
                }
            },
            estrella6: {
                label: 'Radio Exterior (px)', propKey: 'radio', default: 200,
                color: '#008080', fill: '#AFEEEE',
                dibujar: function(ctx, params) {
                    const radio = params.radio;
                    const radioInterior = radio * 0.5; 
                    const numPuntas = 6;
                    const angleIncrement = Math.PI / numPuntas;
                    for (let i = 0; i < 2 * numPuntas; i++) {
                        const r = (i % 2 === 0) ? radio : radioInterior;
                        const angle = i * angleIncrement - Math.PI / 2;
                        const x = r * Math.cos(angle);
                        const y = r * Math.sin(angle);
                        (i === 0) ? ctx.moveTo(x, y) : ctx.lineTo(x, y);
                    }
                    ctx.closePath();
                }
            },
            mediaLuna: {
                label: 'Radio (px)', propKey: 'radio', default: 200,
                color: '#A9A9A9', fill: '#F5F5F5',
                dibujar: function(ctx, params) {
                    const radio = params.radio;
                    ctx.arc(0, 0, radio, Math.PI / 2, 3 * Math.PI / 2);
                    ctx.bezierCurveTo(
                        radio / 4, -radio * 0.8,
                        radio / 4, radio * 0.8,
                        0, radio
                    );
                    ctx.closePath();
                }
            },
            arco: {
                labels: ['Radio (px)', '츼ngulo (grados)'], propKeys: ['radio', 'angulo'], defaults: [200, 120],
                color: '#FF6347', fill: '#FFA07A',
                dibujar: function(ctx, params) {
                    const radio = params.radio;
                    const anguloRad = params.angulo * (Math.PI / 180);
                    const startAngle = -Math.PI / 2 - anguloRad / 2;
                    const endAngle = -Math.PI / 2 + anguloRad / 2;

                    ctx.moveTo(0, 0); 
                    ctx.arc(0, 0, radio, startAngle, endAngle);
                    ctx.closePath();
                }
            },
            donut: {
                labels: ['Radio Exterior', 'Radio Interior'], propKeys: ['radioExt', 'radioInt'], defaults: [200, 120],
                color: '#FF69B4', fill: '#FFB6C1',
                dibujar: function(ctx, params) {
                    const { radioExt, radioInt } = params;
                    ctx.arc(0, 0, radioExt, 0, 2 * Math.PI);
                    ctx.moveTo(radioInt, 0);
                    ctx.arc(0, 0, radioInt, 0, 2 * Math.PI, true); 
                }
            },
            flecha: {
                labels: ['Longitud', 'Ancho Cabeza'], propKeys: ['longitud', 'anchoCabeza'], defaults: [300, 100],
                color: '#1E90FF', fill: '#ADD8E6',
                dibujar: function(ctx, params) {
                    const { longitud, anchoCabeza } = params;
                    const anchoCola = anchoCabeza / 3;
                    const altoCabeza = longitud / 3;
                    const altoCola = longitud - altoCabeza;

                    ctx.moveTo(-anchoCola / 2, altoCola / 2); 
                    ctx.lineTo(anchoCola / 2, altoCola / 2);  
                    ctx.lineTo(anchoCola / 2, altoCola / 2 - altoCabeza); 
                    ctx.lineTo(anchoCabeza / 2, altoCola / 2 - altoCabeza); 
                    ctx.lineTo(0, -longitud / 2); 
                    ctx.lineTo(-anchoCabeza / 2, altoCola / 2 - altoCabeza); 
                    ctx.lineTo(-anchoCola / 2, altoCola / 2 - altoCabeza); 
                    ctx.closePath();
                }
            },
            nuve: {
                label: 'Tama침o Base (px)', propKey: 'base', default: 300,
                color: '#87CEFA', fill: '#FFFFFF',
                dibujar: function(ctx, params) {
                    const base = params.base;
                    const factor = base / 300;

                    ctx.moveTo(-base / 2, base * 0.1);
                    ctx.arc(-base / 2 + 50 * factor, base * 0.1, 50 * factor, Math.PI, 0, false);
                    ctx.arc(-base / 2 + 150 * factor, -30 * factor, 70 * factor, Math.PI, 0, false);
                    ctx.arc(-base / 2 + 250 * factor, 10 * factor, 60 * factor, Math.PI, 0, false);
                    ctx.arc(-base / 2 + 350 * factor, base * 0.1, 50 * factor, Math.PI, 0, false);
                    ctx.closePath();
                }
            },
            diamante: {
                labels: ['Ancho', 'Alto'], propKeys: ['ancho', 'alto'], defaults: [200, 300],
                color: '#00BFFF', fill: '#B0E0E6',
                dibujar: function(ctx, params) {
                    const { ancho, alto } = params;
                    const medioAlto = alto * 0.6; 
                    const halfAncho = ancho / 2;
                    
                    ctx.moveTo(0, -medioAlto); 
                    ctx.lineTo(halfAncho, 0);
                    ctx.lineTo(0, alto - medioAlto); 
                    ctx.lineTo(-halfAncho, 0);
                    ctx.closePath();
                }
            },
            rectanguloRedondeado: {
                labels: ['Base', 'Altura', 'Radio Esquina'], propKeys: ['base', 'altura', 'radio'], defaults: [300, 150, 20],
                color: '#3CB371', fill: '#98FB98',
                dibujar: function(ctx, params) {
                    const { base, altura, radio } = params;
                    const x = -base / 2;
                    const y = -altura / 2;
                    
                    ctx.moveTo(x + radio, y);
                    ctx.lineTo(x + base - radio, y);
                    ctx.arcTo(x + base, y, x + base, y + radio, radio);
                    ctx.lineTo(x + base, y + altura - radio);
                    ctx.arcTo(x + base, y + altura, x + base - radio, y + altura, radio);
                    ctx.lineTo(x + radio, y + altura);
                    ctx.arcTo(x, y + altura, x, y + altura - radio, radio);
                    ctx.lineTo(x, y + radio);
                    ctx.arcTo(x, y, x + radio, y, radio);
                    ctx.closePath();
                }
            },
            trianguloRectangulo: {
                labels: ['Base', 'Altura'], propKeys: ['base', 'altura'], defaults: [300, 200],
                color: '#A0522D', fill: '#D2B48C',
                dibujar: function(ctx, params) {
                    const { base, altura } = params;
                    ctx.moveTo(-base / 2, altura / 2); 
                    ctx.lineTo(base / 2, altura / 2);  
                    ctx.lineTo(base / 2, -altura / 2); 
                    ctx.closePath();
                }
            },
            pino: {
                labels: ['Ancho Base', 'Altura Total'], propKeys: ['ancho', 'alto'], defaults: [250, 400],
                color: '#228B22', fill: '#3CB371',
                dibujar: function(ctx, params) {
                    const { ancho, alto } = params;
                    const baseTronco = ancho / 5;
                    const altoTronco = alto / 8;
                    const altoTriangulo = alto - altoTronco;

                    ctx.beginPath(); // Nuevo path para el 치rbol
                    ctx.moveTo(0, -alto / 2);
                    ctx.lineTo(ancho / 2, alto / 2 - altoTronco);
                    ctx.lineTo(-ancho / 2, alto / 2 - altoTronco);
                    ctx.closePath();
                    ctx.fill();
                    ctx.stroke();

                    // Tronco
                    ctx.beginPath(); // Nuevo path para el tronco
                    ctx.fillStyle = '#8B4513'; 
                    ctx.fillRect(-baseTronco / 2, alto / 2 - altoTronco, baseTronco, altoTronco);
                    ctx.stroke();
                }
            },
            gota: {
                label: 'Tama침o Base (px)', propKey: 'base', default: 200,
                color: '#1E90FF', fill: '#87CEEB',
                dibujar: function(ctx, params) {
                    const base = params.base;
                    const scale = base / 200;

                    ctx.moveTo(0, -100 * scale); 
                    ctx.bezierCurveTo(
                        70 * scale, -50 * scale, 
                        70 * scale, 50 * scale, 
                        0, 100 * scale 
                    );
                    ctx.bezierCurveTo(
                        -70 * scale, 50 * scale, 
                        -70 * scale, -50 * scale, 
                        0, -100 * scale 
                    );
                    ctx.closePath();
                }
            },
            bandera: {
                labels: ['Ancho', 'Alto'], propKeys: ['ancho', 'alto'], defaults: [350, 200],
                color: '#DCDCDC', fill: '#F0F8FF',
                dibujar: function(ctx, params) {
                    const { ancho, alto } = params;
                    const halfAncho = ancho / 2;
                    const halfAlto = alto / 2;

                    ctx.moveTo(-halfAncho, -halfAlto);
                    ctx.lineTo(halfAncho, -halfAlto);
                    ctx.quadraticCurveTo(halfAncho + 20, 0, halfAncho, halfAlto);
                    ctx.lineTo(-halfAncho, halfAlto);
                    ctx.quadraticCurveTo(-halfAncho - 20, 0, -halfAncho, -halfAlto);
                    ctx.closePath();
                }
            },
            engranaje: {
                label: 'Radio (px)', propKey: 'radio', default: 200,
                color: '#696969', fill: '#A9A9A9',
                dibujar: function(ctx, params) {
                    const radio = params.radio;
                    const numDientes = 12;
                    const anchoDiente = Math.PI / numDientes / 2;
                    const radioInt = radio * 0.7;
                    const radioEje = radio * 0.3;
                    
                    for (let i = 0; i < numDientes; i++) {
                        const angle = i * (2 * Math.PI) / numDientes;
                        
                        ctx.lineTo(radio * Math.cos(angle + anchoDiente), radio * Math.sin(angle + anchoDiente));
                        ctx.lineTo(radioInt * Math.cos(angle + anchoDiente * 2), radioInt * Math.sin(angle + anchoDiente * 2));
                        
                        ctx.lineTo(radioInt * Math.cos(angle - anchoDiente * 2), radioInt * Math.sin(angle - anchoDiente * 2));
                        ctx.lineTo(radio * Math.cos(angle - anchoDiente), radio * Math.sin(angle - anchoDiente));
                    }
                    
                    // Define el agujero central
                    ctx.moveTo(radioEje, 0);
                    ctx.arc(0, 0, radioEje, 0, 2 * Math.PI, true);
                    ctx.closePath();
                }
            },
            cruz: {
                labels: ['Longitud', 'Grosor'], propKeys: ['longitud', 'grosor'], defaults: [300, 80],
                color: '#8B0000', fill: '#FF0000',
                dibujar: function(ctx, params) {
                    const { longitud, grosor } = params;
                    const halfLong = longitud / 2;
                    const halfGrosor = grosor / 2;

                    ctx.moveTo(-halfGrosor, -halfLong);
                    ctx.lineTo(halfGrosor, -halfLong);
                    ctx.lineTo(halfGrosor, -halfGrosor);
                    ctx.lineTo(halfLong, -halfGrosor);
                    ctx.lineTo(halfLong, halfGrosor);
                    ctx.lineTo(halfGrosor, halfGrosor);
                    ctx.lineTo(halfGrosor, halfLong);
                    ctx.lineTo(-halfGrosor, halfLong);
                    ctx.lineTo(-halfGrosor, halfGrosor);
                    ctx.lineTo(-halfLong, halfGrosor);
                    ctx.lineTo(-halfLong, -halfGrosor);
                    ctx.lineTo(-halfGrosor, -halfGrosor);
                    ctx.closePath();
                }
            },
            pacman: {
                label: 'Radio (px)', propKey: 'radio', default: 200,
                color: '#FFD700', fill: '#FFFF00',
                dibujar: function(ctx, params) {
                    const radio = params.radio;
                    const anguloApertura = Math.PI / 6; 
                    ctx.moveTo(0, 0);
                    ctx.arc(0, 0, radio, anguloApertura, 2 * Math.PI - anguloApertura);
                    ctx.closePath();
                }
            },
            rayo: {
                labels: ['Longitud', 'Ancho'], propKeys: ['longitud', 'ancho'], defaults: [300, 150],
                color: '#FF8C00', fill: '#FFA500',
                dibujar: function(ctx, params) {
                    const { longitud, ancho } = params;
                    const halfLong = longitud / 2;
                    const halfAncho = ancho / 2;

                    ctx.moveTo(-halfAncho / 2, -halfLong); 
                    ctx.lineTo(halfAncho, 0); 
                    ctx.lineTo(-halfAncho / 2, 0);
                    ctx.lineTo(halfAncho, halfLong); 
                    ctx.lineTo(-halfAncho, 0); 
                    ctx.lineTo(halfAncho / 2, 0);
                    ctx.closePath();
                }
            },
            bala: {
                labels: ['Base', 'Altura'], propKeys: ['base', 'altura'], defaults: [150, 300],
                color: '#B8860B', fill: '#DAA520',
                dibujar: function(ctx, params) {
                    const { base, altura } = params;
                    const radio = base / 2;
                    const altoRect = altura - radio;
                    
                    // Base (Rect치ngulo) - Dibuja primero el rect치ngulo
                    ctx.rect(-radio, -radio + altoRect, base, altoRect);
                    
                    // C칰pula (Arco superior) - Luego, el arco
                    ctx.arc(0, -radio, radio, Math.PI, 2 * Math.PI);
                    ctx.closePath();
                }
            },
            tetaedro: {
                label: 'Radio Base (px)', propKey: 'radio', default: 200,
                color: '#6A5ACD', fill: '#E6E6FA',
                dibujar: function(ctx, params) {
                    const radio = params.radio;
                    const numLados = 3;
                    const angleIncrement = (2 * Math.PI) / numLados;
                    
                    // Dibuja el tri치ngulo base 
                    for (let i = 0; i < numLados; i++) {
                        const angle = i * angleIncrement - Math.PI / 2; 
                        const x = radio * Math.cos(angle);
                        const y = radio * Math.sin(angle);
                        (i === 0) ? ctx.moveTo(x, y) : ctx.lineTo(x, y);
                    }
                    ctx.closePath();
                    
                    // L칤neas de perspectiva (solo stroke)
                    ctx.stroke(); 
                    
                    ctx.beginPath();
                    ctx.strokeStyle = params.color;
                    ctx.moveTo(0, 0);
                    ctx.lineTo(radio * Math.cos(-Math.PI / 2), radio * Math.sin(-Math.PI / 2));
                    ctx.moveTo(0, 0);
                    ctx.lineTo(radio * Math.cos(angleIncrement - Math.PI / 2), radio * Math.sin(angleIncrement - Math.PI / 2));
                    ctx.moveTo(0, 0);
                    ctx.lineTo(radio * Math.cos(2 * angleIncrement - Math.PI / 2), radio * Math.sin(2 * angleIncrement - Math.PI / 2));
                    
                }
            },
            espiral: {
                labels: ['Radio Inicial', 'Vueltas'], propKeys: ['radioIni', 'vueltas'], defaults: [5, 4],
                color: '#556B2F', fill: 'transparent',
                dibujar: function(ctx, params) {
                    const { radioIni, vueltas } = params;
                    const numPuntos = 1000;
                    ctx.moveTo(0, 0);
                    
                    for (let i = 0; i < numPuntos; i++) {
                        const t = i / numPuntos; 
                        const angle = t * vueltas * 2 * Math.PI;
                        const r = radioIni * angle; 
                        
                        const x = r * Math.cos(angle);
                        const y = r * Math.sin(angle);
                        ctx.lineTo(x, y);
                    }
                }
            },
            escalera: {
                labels: ['Ancho', 'Altura', 'Pelda침os'], propKeys: ['ancho', 'altura', 'pelda침os'], defaults: [300, 300, 5],
                color: '#8B4513', fill: '#D2B48C',
                dibujar: function(ctx, params) {
                    const { ancho, altura, pelda침os } = params;
                    const stepX = ancho / pelda침os;
                    const stepY = altura / pelda침os;
                    
                    ctx.moveTo(-ancho / 2, altura / 2); 
                    
                    for (let i = 0; i < pelda침os; i++) {
                        const x = -ancho / 2 + i * stepX;
                        const y = altura / 2 - i * stepY;
                        
                        ctx.lineTo(x + stepX, y); // Horizontal
                        ctx.lineTo(x + stepX, y - stepY); // Vertical
                    }
                    
                    ctx.lineTo(ancho / 2, -altura / 2);
                    ctx.lineTo(-ancho / 2, altura / 2);
                    ctx.closePath();
                }
            }
        };

        // === Inicializaci칩n y DOM ===
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const selectFigura = document.getElementById('figura');
        const divParametros = document.getElementById('parametros');
        const colorBorde = document.getElementById('colorBorde');
        const colorRelleno = document.getElementById('colorRelleno');
        const dibujarBtn = document.getElementById('dibujarBtn');
        const limpiarBtn = document.getElementById('limpiarBtn');
        const errorMessageDiv = document.getElementById('errorMessage');
        
        const splashScreen = document.getElementById('splash-screen');
        const iniciarAppBtn = document.getElementById('iniciarAppBtn');
        const appContent = document.getElementById('app-content');

        /**
         * Maneja la transici칩n de la pantalla de inicio a la aplicaci칩n.
         */
        function iniciarAplicacion() {
            splashScreen.classList.add('hidden');

            setTimeout(() => {
                splashScreen.style.display = 'none';
                appContent.style.display = 'flex';
                // Cargar par치metros iniciales (Cuadrado)
                cargarParametros(); 
            }, 500); 
        }

        /**
         * Carga los inputs de par치metros y colores por defecto para la figura seleccionada.
         */
        function cargarParametros() {
            const figura = selectFigura.value;
            const figuraData = figurasDB[figura];
            divParametros.innerHTML = '';
            errorMessageDiv.textContent = ''; 
            
            colorBorde.value = figuraData.color;
            // Asegura que el color de relleno se respete, o usa transparente si se define as칤
            colorRelleno.value = figuraData.fill === 'transparent' ? '#FFFFFF' : figuraData.fill; 

            const keysToProcess = figuraData.propKeys || (figuraData.propKey ? [figuraData.propKey] : []);
            const labelsToProcess = figuraData.labels || (figuraData.label ? [figuraData.label] : []);
            const defaultsToProcess = figuraData.defaults || (figuraData.default ? [figuraData.default] : []);

            keysToProcess.forEach((key, index) => {
                const labelText = labelsToProcess[index];
                const defaultValue = defaultsToProcess[index];
                
                const label = document.createElement('label');
                label.setAttribute('for', key);
                label.textContent = `${labelText}: `;

                const input = document.createElement('input');
                input.type = 'number';
                input.id = key;
                input.min = '1';
                input.placeholder = `Ej: ${defaultValue}`;
                input.value = defaultValue;

                divParametros.appendChild(label);
                divParametros.appendChild(input);
                divParametros.appendChild(document.createElement('br'));
            });
        }

        /**
         * Lee los par치metros de entrada y dibuja la figura en el canvas.
         */
        function dibujarFigura() {
            const figura = selectFigura.value;
            const figuraData = figurasDB[figura];
            let params = {
                color: colorBorde.value,
                fill: figuraData.fill === 'transparent' ? 'transparent' : colorRelleno.value
            };
            
            let isValid = true;
            let keys = figuraData.propKeys || (figuraData.propKey ? [figuraData.propKey] : []);

            keys.forEach((key, index) => {
                const input = document.getElementById(key);
                const value = parseInt(input.value);
                
                if (isNaN(value) || value <= 0) {
                    errorMessageDiv.textContent = `Error: El valor de "${figuraData.labels ? figuraData.labels[index] : figuraData.label}" debe ser un n칰mero positivo.`;
                    isValid = false;
                    return;
                }
                params[key] = value;
            });
            
            if (!isValid) return;
            errorMessageDiv.textContent = ''; 

            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.save();
            ctx.translate(canvas.width / 2, canvas.height / 2);

            ctx.fillStyle = params.fill;
            ctx.strokeStyle = params.color;
            ctx.lineWidth = 4;

            // Manejo especial para el pino (que dibuja dos cosas separadas) y la espiral
            if (figura === 'pino') {
                figuraData.dibujar(ctx, params);
            } else if (figura === 'tetaedro' || figura === 'espiral') {
                // Para figuras que son solo l칤neas (stroke), solo se dibuja la l칤nea
                ctx.beginPath();
                figuraData.dibujar(ctx, params);
                ctx.stroke();
            }
            else {
                ctx.beginPath();
                figuraData.dibujar(ctx, params);
                ctx.fill();
                ctx.stroke();
            }

            ctx.restore();
        }

        /**
         * Limpia todo el contenido del canvas.
         */
        function limpiarCanvas() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
        }

        // === Event Listeners ===
        selectFigura.addEventListener('change', cargarParametros);
        dibujarBtn.addEventListener('click', dibujarFigura);
        limpiarBtn.addEventListener('click', limpiarCanvas);
        
        iniciarAppBtn.addEventListener('click', iniciarAplicacion);
    </script>
    </body>
</html>